{"ast":null,"code":"import _defineProperty from \"/Users/maksim/Documents/Worksapce/todo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _createForOfIteratorHelper from \"/Users/maksim/Documents/Worksapce/todo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";\nvar _jsxFileName = \"/Users/maksim/Documents/Worksapce/todo/src/index.js\";\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nReactDOM.render( /*#__PURE__*/_jsxDEV(React.StrictMode, {\n  children: /*#__PURE__*/_jsxDEV(App, {}, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 9,\n    columnNumber: 5\n  }, this)\n}, void 0, false, {\n  fileName: _jsxFileName,\n  lineNumber: 8,\n  columnNumber: 3\n}, this), document.getElementById('root')); // If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\n\nreportWebVitals();\nvar sidebar = document.querySelector(\".sidebar\");\nvar closeBtn = document.querySelector(\"#btn\");\nvar searchBtn = document.querySelector(\".bx-search\");\ncloseBtn.addEventListener(\"click\", function () {\n  sidebar.classList.toggle(\"open\");\n  menuBtnChange(); //calling the function(optional)\n});\nsearchBtn.addEventListener(\"click\", function () {\n  // Sidebar open when you click on the search iocn\n  sidebar.classList.toggle(\"open\");\n  menuBtnChange(); //calling the function(optional)\n}); // following are the code to change sidebar button(optional)\n\nfunction menuBtnChange() {\n  if (sidebar.classList.contains(\"open\")) {\n    closeBtn.classList.replace(\"bx-menu\", \"bx-menu-alt-right\"); //replacing the iocns class\n  } else {\n    closeBtn.classList.replace(\"bx-menu-alt-right\", \"bx-menu\"); //replacing the iocns class\n  }\n}\n\nfunction cx(classNames) {\n  var names = '';\n\n  if (typeof classNames == 'object') {\n    for (var name in classNames) {\n      if (!classNames.hasOwnProperty(name) || !classNames[name]) {\n        continue;\n      }\n\n      names += name + ' ';\n    }\n  } else {\n    for (var i = 0; i < arguments.length; i++) {\n      // We should technically exclude 0 too, but for the sake of backward\n      // compat we'll keep it (for now)\n      if (arguments[i] == null) {\n        continue;\n      }\n\n      names += arguments[i] + ' ';\n    }\n  }\n\n  return names.trim();\n}\n\nvar TODO_ID = Date.now(); // Data Model\n\nvar ToDo = Immutable.Record({\n  id: 0,\n  summary: '',\n  status: 'open',\n  tags: []\n});\n\nfunction newToDo(summary) {\n  return new ToDo({\n    id: TODO_ID++,\n    summary: summary\n  });\n}\n\n; // Actions and Store\n\nvar actionAdd = Reflux.createAction();\nvar actionRemove = Reflux.createAction();\nvar actionCheck = Reflux.createAction();\nvar actionUncheck = Reflux.createAction();\nvar actionTag = Reflux.createAction();\nvar actionFilter = Reflux.createAction();\nvar storeTodos = Reflux.createStore({\n  init: function init() {\n    var _this = this;\n\n    this.filteringTags = Immutable.fromJS([]);\n    this.items = [];\n    this.filtered = this.items;\n    console.log('Opening a new database');\n    var request = indexedDB.open('todos', 2);\n\n    request.onsuccess = function (e) {\n      _this.db = e.target.result;\n      console.log('TODOs database has been created under the name \"todos\".');\n\n      var objectStore = _this.db.transaction('todos').objectStore('todos');\n\n      objectStore.openCursor().onsuccess = _this.onCursor;\n    };\n\n    request.onerror = function (e) {\n      console.error('An error has occurred. ERR: ' + e.message);\n    };\n\n    request.onupgradeneeded = function (e) {\n      var db = e.target.result;\n      console.log('Creating object store \"todos\"');\n      var objectStore = db.createObjectStore('todos', {\n        keyPath: 'id'\n      });\n\n      objectStore.transaction.oncomplete = function () {\n        console.info('Object store has been created');\n      };\n    };\n\n    this.listenTo(actionAdd, this.onActionAdd);\n    this.listenTo(actionRemove, this.onActionRemove);\n    this.listenTo(actionCheck, this.onActionCheck);\n    this.listenTo(actionUncheck, this.onActionUncheck);\n    this.listenTo(actionTag, this.onActionTag);\n    this.listenTo(actionFilter, this.onActionFilter);\n  },\n  onCursor: function onCursor(e) {\n    var cursor = e.target.result;\n\n    if (!cursor) {\n      // We have no more data\n      console.info('No more items');\n      this.trigger(this.items);\n      return;\n    }\n\n    var todo = cursor.value;\n    console.log('Loading item: ', todo.summary);\n    this.items.push(Immutable.fromJS(todo));\n    cursor[\"continue\"]();\n  },\n  onActionAdd: function onActionAdd(data) {\n    var _this2 = this;\n\n    var todo = data;\n    console.log('Action is being handled: %s', todo.summary);\n    var tx = this.db.transaction(['todos'], 'readwrite');\n    var request = tx.objectStore('todos').add(todo.toJS());\n\n    request.onsuccess = function (e) {\n      var newID = e.target.result;\n      console.info('Done added new todo record %s', newID);\n\n      _this2.items.unshift(todo);\n\n      console.log('Synchronizing UI...');\n\n      _this2.triggerAsync(_this2.filtered);\n    };\n  },\n  onActionRemove: function onActionRemove(data) {\n    var _this3 = this;\n\n    var todo = data;\n    console.assert(this.items, 'onActionRemove (data)');\n    var index = this.items.indexOf(todo);\n    console.log('Removing todo item \"%s\" at index %s', todo.summary, index);\n    var request = this.db.transaction(['todos'], \"readwrite\").objectStore('todos')[\"delete\"](todo.get('id'));\n\n    request.onsuccess = function (e) {\n      _this3.items.splice(index, 1);\n\n      _this3.triggerAsync(_this3.filtered);\n    };\n  },\n  onActionCheck: function onActionCheck(data) {\n    var _this4 = this;\n\n    var todo = data;\n    console.log('Store: Checking item as \"done\": %s = %s', todo.get('id'), todo.get('summary'));\n    var objectStore = this.db.transaction(['todos'], \"readwrite\").objectStore('todos');\n    var updatedToDo = todo.update('status', function (status) {\n      return 'done';\n    });\n    var request = objectStore.put(updatedToDo.toJS());\n\n    request.onsuccess = function (e) {\n      console.log('Store: Backend has been updated.');\n\n      var index = _this4.items.indexOf(todo);\n\n      _this4.items.splice(index, 1, updatedToDo);\n\n      _this4.trigger(_this4.filtered);\n    };\n  },\n  onActionUncheck: function onActionUncheck(data) {\n    var _this5 = this;\n\n    var todo = data;\n    console.log('Store: Checking item as \"open\": %s = %s', todo.get('id'), todo.get('summary'));\n    var objectStore = this.db.transaction(['todos'], \"readwrite\").objectStore('todos');\n    var updatedToDo = todo.update('status', function (status) {\n      return 'open';\n    });\n    var request = objectStore.put(updatedToDo.toJS());\n\n    request.onsuccess = function (e) {\n      console.log('Store: Backend has been updated.');\n\n      var index = _this5.items.indexOf(todo);\n\n      _this5.items.splice(index, 1, updatedToDo);\n\n      _this5.trigger(_this5.filtered);\n    };\n  },\n  onActionTag: function onActionTag(todo, tags) {\n    var _this6 = this;\n\n    console.log('Store: Updating item\\'s tags as \"%o\" for %s', tags, todo.get('id'));\n    var objectStore = this.db.transaction(['todos'], \"readwrite\").objectStore('todos');\n    var updatedToDo = todo.update('tags', function (value) {\n      return tags;\n    });\n    console.log('Updated: ', updatedToDo.toJS());\n    var request = objectStore.put(updatedToDo.toJS());\n\n    request.onsuccess = function (e) {\n      console.log('Store: Backend has been updated.');\n\n      var index = _this6.items.indexOf(todo);\n\n      _this6.items[index] = updatedToDo;\n      console.log('Item\\'s new tags: ', tags);\n      var shouldKeepInFiltered = false;\n\n      if (_this6.filteringTags.size === 0) {\n        // There is no filtering\n        shouldKeepInFiltered = true; // No effect here! Leave here for clarity\n      } else {\n        var _iterator = _createForOfIteratorHelper(tags),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var tag = _step.value;\n\n            if (_this6.filteringTags.includes(tag)) {\n              shouldKeepInFiltered = true;\n              break;\n            }\n          } // TODO Improve this iteration\n\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n\n        if (!shouldKeepInFiltered) {\n          var filtered = _this6.items.filter(function (item) {\n            var _iterator2 = _createForOfIteratorHelper(_this6.filteringTags),\n                _step2;\n\n            try {\n              for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n                var tag = _step2.value;\n\n                if (item.get('tags').indexOf(tag) !== -1) {\n                  return true;\n                }\n              }\n            } catch (err) {\n              _iterator2.e(err);\n            } finally {\n              _iterator2.f();\n            }\n\n            return false;\n          });\n\n          _this6.filtered = filtered;\n\n          _this6.triggerAsync(_this6.filtered);\n        }\n      }\n    };\n  },\n  onActionFilter: function onActionFilter(data) {\n    console.log('Store: Filtering by tags: %o', data);\n    var tags = data;\n\n    if (!tags.length) {\n      this.filtered = this.items;\n      this.triggerAsync(this.filtered);\n      return;\n    }\n\n    this.filteringTags = Immutable.fromJS(tags);\n    console.log('Updated filtering tags: ', this.filteringTags);\n    var filtered = this.items.filter(function (item) {\n      var _iterator3 = _createForOfIteratorHelper(tags),\n          _step3;\n\n      try {\n        for (_iterator3.s(); !(_step3 = _iterator3.n()).done;) {\n          var tag = _step3.value;\n\n          if (item.get('tags').indexOf(tag) !== -1) {\n            return true;\n          }\n        }\n      } catch (err) {\n        _iterator3.e(err);\n      } finally {\n        _iterator3.f();\n      }\n\n      return false;\n    });\n    this.filtered = filtered;\n    this.triggerAsync(this.filtered);\n  }\n}); // Views\n\nvar EditBox = React.createClass({\n  displayName: \"EditBox\",\n  getInitialState: function getInitialState() {\n    return {\n      text: ''\n    };\n  },\n  handleChange: function handleChange(event) {\n    this.setState({\n      text: event.target.value\n    });\n  },\n  render: function render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"editbox\",\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        ref: \"taskSummary\",\n        placeholder: \"Default value\",\n        value: this.state.text,\n        onChange: this.handleChange,\n        className: \"editbox__textbox\",\n        onKeyUp: this.onTextKeyup\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 287,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"editbox__button-add\",\n        onClick: this.onAddClicked,\n        children: \"Add\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 288,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 7\n    }, this);\n  },\n  doAdd: function doAdd() {\n    var taskSummary = this.refs.taskSummary.getDOMNode().value;\n\n    if (!taskSummary) {\n      return;\n    }\n\n    var todo = newToDo(taskSummary);\n    actionAdd(todo);\n    this.refs.taskSummary.getDOMNode().value = null;\n  },\n  onTextKeyup: function onTextKeyup(e) {\n    if (e.keyCode !== 13) return;\n    this.doAdd();\n  },\n  onAddClicked: function onAddClicked() {\n    this.doAdd();\n  }\n});\nvar TagBox = React.createClass({\n  displayName: \"TagBox\",\n  statics: {\n    tags: [{\n      value: 'home',\n      label: 'Home'\n    }, {\n      value: 'work',\n      label: 'Work'\n    }, {\n      value: 'star',\n      label: 'Star'\n    }]\n  },\n  getInitialState: function getInitialState() {\n    return {\n      tags: []\n    };\n  },\n  render: function render() {\n    var _this7 = this;\n\n    var selectedTags = this.state.tags;\n    var tagList = TagBox.tags.map(function (tag) {\n      var classes = cx(_defineProperty({\n        'tagbox__item': true,\n        'is-checked': selectedTags.indexOf(tag.value) !== -1\n      }, 'is-' + tag.value, true));\n      return /*#__PURE__*/_jsxDEV(\"span\", {\n        className: classes,\n        onClick: _this7.toggleFilter.bind(null, tag.value),\n        children: tag.label\n      }, tag.value, false, {\n        fileName: _jsxFileName,\n        lineNumber: 336,\n        columnNumber: 9\n      }, _this7);\n    });\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"tagbox\",\n      children: tagList\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 345,\n      columnNumber: 7\n    }, this);\n  },\n  toggleFilter: function toggleFilter(tag) {\n    console.log('Adding more tag to the filter: %s', tag);\n    var tags = this.state.tags;\n    var index = tags.indexOf(tag);\n\n    if (index === -1) {\n      tags.push(tag);\n    } else {\n      tags.splice(index, 1);\n    }\n\n    console.log('Filtering by tags: %o', tags);\n    this.setState({\n      tags: tags\n    });\n    actionFilter(tags);\n  }\n});\nvar Tags = React.createClass({\n  displayName: \"Tags\",\n  statics: {\n    tags: [{\n      value: 'home',\n      label: 'Home'\n    }, {\n      value: 'work',\n      label: 'Work'\n    }, {\n      value: 'star',\n      label: 'Star'\n    }]\n  },\n  getInitialState: function getInitialState() {\n    return {\n      tags: Immutable.fromJS(this.props.tags || []),\n      editing: false\n    };\n  },\n  render: function render() {\n    var _cx2,\n        _this8 = this;\n\n    var classes = cx((_cx2 = {\n      'todo-tags': true\n    }, _defineProperty(_cx2, this.props.className, true), _defineProperty(_cx2, 'is-editing', this.state.editing), _defineProperty(_cx2, 'is-tagged', this.state.tags.size > 0), _cx2));\n    var dropdown;\n\n    if (this.state.editing) {\n      dropdown = /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"todo-tags__dropdown\",\n        children: Tags.tags.map(function (tag) {\n          return /*#__PURE__*/_jsxDEV(\"li\", {\n            className: \"todo-tags__item\",\n            onClick: _this8.toggleTag.bind(_this8, tag.value),\n            children: tag.label\n          }, tag.value, false, {\n            fileName: _jsxFileName,\n            lineNumber: 398,\n            columnNumber: 33\n          }, _this8);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 397,\n        columnNumber: 9\n      }, this);\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: classes,\n      onClick: this.toggleEdit,\n      onBlur: this.endEdit,\n      tabIndex: \"0\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"todo-tags__label\",\n        children: this.state.tags.size === 0 ? 'tags' : this.state.tags.map(function (tag) {\n          var classes = cx(_defineProperty({\n            'todo-tags__value': true\n          }, 'is-' + tag, true));\n          return /*#__PURE__*/_jsxDEV(\"span\", {\n            className: classes,\n            children: tag\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 412,\n            columnNumber: 21\n          }, _this8);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 9\n      }, this), dropdown]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 404,\n      columnNumber: 7\n    }, this);\n  },\n  toggleEdit: function toggleEdit(e) {\n    e.stopPropagation();\n\n    if (this.state.editing) {\n      this.endEdit();\n    } else {\n      this.beginEdit();\n    }\n  },\n  beginEdit: function beginEdit() {\n    if (this.state.editing) {\n      return;\n    }\n\n    this.setState({\n      'editing': true\n    });\n    Tags.activeID = null; //this.getID();\n  },\n  endEdit: function endEdit() {\n    console.log('Ending edit...');\n\n    if (Tags.active && Tags.active === this) {\n      Tags.active = null;\n    }\n\n    this.setState({\n      'editing': false\n    });\n  },\n  toggleTag: function toggleTag(tag, e) {\n    e.stopPropagation();\n    var tags = this.state.tags;\n\n    if (!tags) {\n      console.assert(!tags, 'Tags is expected');\n      return;\n    }\n\n    var index = tags.indexOf(tag);\n\n    if (index === -1) {\n      tags = tags.push(tag);\n    } else {\n      tags = tags[\"delete\"](index);\n    }\n\n    this.setState({\n      tags: tags\n    });\n    var onToggleTag = this.props.onToggleTag;\n\n    if (!onToggleTag) {\n      console.info('No handler for onToggleTag');\n      return;\n    }\n\n    onToggleTag(tags);\n    this.endEdit();\n  }\n});\n_c = Tags;\nvar ToDoList = React.createClass({\n  displayName: \"ToDoList\",\n  getInitialState: function getInitialState() {\n    return {\n      items: Immutable.fromJS(storeTodos.items)\n    };\n  },\n  componentDidMount: function componentDidMount() {\n    var _this9 = this;\n\n    this.stopListening = storeTodos.listen(function (data) {\n      _this9.setState({\n        items: Immutable.fromJS(data) // Freeze the object state\n\n      });\n    });\n  },\n  componentWillUnmount: function componentWillUnmount() {\n    this.stopListening();\n  },\n  render: function render() {\n    var _this10 = this;\n\n    var content;\n\n    if (!this.state.items.size) {\n      content = /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"todo-list\",\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"todo-list__message\",\n          children: \"You have nothing to do!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 497,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 496,\n        columnNumber: 9\n      }, this);\n    } else {\n      var items = this.state.items.map(function (item) {\n        var boundRemovedClicked = _this10.onRemovedDelegate.bind(_this10, item);\n\n        var boundItemClicked = item.get('status') === 'done' ? _this10.onUncheckDelegate.bind(_this10, item) : _this10.onCheckDelegate.bind(_this10, item);\n\n        var boundItemTag = _this10.onTagDelegate.bind(_this10, item);\n\n        var classes = cx({\n          'todo-list__item todo-item': true,\n          'is-checked': item.get('status') === 'done'\n        });\n        return /*#__PURE__*/_jsxDEV(\"li\", {\n          className: classes,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"todo-item__checkmark\",\n            onClick: boundItemClicked\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 516,\n            columnNumber: 13\n          }, _this10), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"todo-item__summary\",\n            children: item.get('summary')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 517,\n            columnNumber: 13\n          }, _this10), /*#__PURE__*/_jsxDEV(Tags, {\n            className: \"todo-item__tags\",\n            tags: item.get('tags'),\n            editable: \"true\",\n            onToggleTag: boundItemTag\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 518,\n            columnNumber: 13\n          }, _this10), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"todo-item__remove\",\n            onClick: boundRemovedClicked,\n            children: \"\\u2718\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 519,\n            columnNumber: 13\n          }, _this10)]\n        }, item.get('id'), true, {\n          fileName: _jsxFileName,\n          lineNumber: 515,\n          columnNumber: 11\n        }, _this10);\n      }); //*/\n\n      content = /*#__PURE__*/_jsxDEV(\"ul\", {\n        className: \"todo-list\",\n        children: items\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 525,\n        columnNumber: 9\n      }, this);\n    }\n\n    return content;\n  },\n  onCheckDelegate: function onCheckDelegate(item) {\n    actionCheck(item);\n  },\n  onUncheckDelegate: function onUncheckDelegate(item) {\n    actionUncheck(item);\n  },\n  onRemovedDelegate: function onRemovedDelegate(item) {\n    actionRemove(item);\n  },\n  onTagDelegate: function onTagDelegate(item, tags) {\n    console.log('Tags applied to item %s: %o', item.get('summary'), tags);\n    actionTag(item, tags);\n  }\n});\n\nvar _c;\n\n$RefreshReg$(_c, \"Tags\");","map":{"version":3,"sources":["/Users/maksim/Documents/Worksapce/todo/src/index.js"],"names":["React","ReactDOM","App","reportWebVitals","render","document","getElementById","sidebar","querySelector","closeBtn","searchBtn","addEventListener","classList","toggle","menuBtnChange","contains","replace","cx","classNames","names","name","hasOwnProperty","i","arguments","length","trim","TODO_ID","Date","now","ToDo","Immutable","Record","id","summary","status","tags","newToDo","actionAdd","Reflux","createAction","actionRemove","actionCheck","actionUncheck","actionTag","actionFilter","storeTodos","createStore","init","filteringTags","fromJS","items","filtered","console","log","request","indexedDB","open","onsuccess","e","db","target","result","objectStore","transaction","openCursor","onCursor","onerror","error","message","onupgradeneeded","createObjectStore","keyPath","oncomplete","info","listenTo","onActionAdd","onActionRemove","onActionCheck","onActionUncheck","onActionTag","onActionFilter","cursor","trigger","todo","value","push","data","tx","add","toJS","newID","unshift","triggerAsync","assert","index","indexOf","get","splice","updatedToDo","update","put","shouldKeepInFiltered","size","tag","includes","filter","item","EditBox","createClass","getInitialState","text","handleChange","event","setState","state","onTextKeyup","onAddClicked","doAdd","taskSummary","refs","getDOMNode","keyCode","TagBox","statics","label","selectedTags","tagList","map","classes","toggleFilter","bind","Tags","props","editing","className","dropdown","toggleTag","toggleEdit","endEdit","stopPropagation","beginEdit","activeID","active","onToggleTag","ToDoList","componentDidMount","stopListening","listen","componentWillUnmount","content","boundRemovedClicked","onRemovedDelegate","boundItemClicked","onUncheckDelegate","onCheckDelegate","boundItemTag","onTagDelegate"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n\nlet sidebar = document.querySelector(\".sidebar\");\nlet closeBtn = document.querySelector(\"#btn\");\nlet searchBtn = document.querySelector(\".bx-search\");\n\ncloseBtn.addEventListener(\"click\", ()=>{\n  sidebar.classList.toggle(\"open\");\n  menuBtnChange();//calling the function(optional)\n});\n\nsearchBtn.addEventListener(\"click\", ()=>{ // Sidebar open when you click on the search iocn\n  sidebar.classList.toggle(\"open\");\n  menuBtnChange(); //calling the function(optional)\n});\n\n// following are the code to change sidebar button(optional)\nfunction menuBtnChange() {\n  if(sidebar.classList.contains(\"open\")){\n    closeBtn.classList.replace(\"bx-menu\", \"bx-menu-alt-right\");//replacing the iocns class\n  }else {\n    closeBtn.classList.replace(\"bx-menu-alt-right\",\"bx-menu\");//replacing the iocns class\n  }\n}\n\nfunction cx(classNames) {\n  var names = '';\n\n  if (typeof classNames == 'object') {\n    for (var name in classNames) {\n      if (!classNames.hasOwnProperty(name) || !classNames[name]) {\n        continue;\n      }\n      names += name + ' ';\n    }\n  } else {\n    for (var i = 0; i < arguments.length; i++) {\n      // We should technically exclude 0 too, but for the sake of backward\n      // compat we'll keep it (for now)\n      if (arguments[i] == null) {\n        continue;\n      }\n      names += arguments[i] + ' ';\n    }\n  }\n\n  return names.trim();\n}\nvar TODO_ID = Date.now();\n// Data Model\nvar ToDo = Immutable.Record({ id: 0, summary: '', status: 'open', tags: []});\nfunction newToDo (summary) {\n  return new ToDo({ id: TODO_ID++, summary: summary });\n};\n\n// Actions and Store\nvar actionAdd = Reflux.createAction();\nvar actionRemove = Reflux.createAction();\nvar actionCheck = Reflux.createAction();\nvar actionUncheck = Reflux.createAction();\nvar actionTag = Reflux.createAction();\nvar actionFilter = Reflux.createAction();\n\nvar storeTodos = Reflux.createStore({\n  init () {\n    this.filteringTags = Immutable.fromJS([]);\n    this.items = [];\n    this.filtered = this.items;\n\n    console.log('Opening a new database');\n    var request = indexedDB.open('todos', 2);\n    request.onsuccess = (e)=> {\n      this.db = e.target.result;\n\n      console.log('TODOs database has been created under the name \"todos\".');\n\n      var objectStore = this.db.transaction('todos').objectStore('todos');\n      objectStore.openCursor().onsuccess = this.onCursor;\n    };\n    request.onerror = (e) => {\n      console.error('An error has occurred. ERR: ' + e.message);\n    };\n    request.onupgradeneeded = (e) => {\n      var db = e.target.result;\n      console.log('Creating object store \"todos\"');\n\n      var objectStore = db.createObjectStore('todos', { keyPath: 'id' });\n      objectStore.transaction.oncomplete = ()=>{\n        console.info('Object store has been created');\n      };\n    };\n\n    this.listenTo(actionAdd, this.onActionAdd);\n    this.listenTo(actionRemove, this.onActionRemove);\n    this.listenTo(actionCheck, this.onActionCheck);\n    this.listenTo(actionUncheck, this.onActionUncheck);\n    this.listenTo(actionTag, this.onActionTag);\n\n    this.listenTo(actionFilter, this.onActionFilter);\n  },\n  onCursor (e) {\n    var cursor = e.target.result;\n\n    if (!cursor) {\n      // We have no more data\n      console.info('No more items');\n      this.trigger(this.items);\n\n      return;\n    }\n\n    var todo = cursor.value;\n    console.log('Loading item: ', todo.summary);\n    this.items.push(Immutable.fromJS(todo));\n\n    cursor.continue();\n  },\n  onActionAdd (data) {\n    var todo = data;\n    console.log('Action is being handled: %s', todo.summary);\n\n    var tx = this.db.transaction(['todos'], 'readwrite');\n    var request = tx.objectStore('todos').add(todo.toJS());\n    request.onsuccess = (e) => {\n      var newID = e.target.result;\n      console.info('Done added new todo record %s', newID);\n\n      this.items.unshift(todo);\n\n      console.log('Synchronizing UI...');\n      this.triggerAsync(this.filtered);\n    };\n  },\n  onActionRemove (data) {\n    var todo = data;\n    console.assert(this.items, 'onActionRemove (data)');\n\n    var index = this.items.indexOf(todo);\n    console.log('Removing todo item \"%s\" at index %s', todo.summary, index);\n\n    var request = this.db.transaction(['todos'], \"readwrite\")\n      .objectStore('todos')\n      .delete(todo.get('id'));\n    request.onsuccess = (e) => {\n      this.items.splice(index,1);\n      this.triggerAsync(this.filtered);\n    };\n  },\n  onActionCheck (data) {\n    var todo = data;\n\n    console.log('Store: Checking item as \"done\": %s = %s', todo.get('id'), todo.get('summary'));\n    var objectStore = this.db.transaction(['todos'], \"readwrite\")\n      .objectStore('todos');\n\n    var updatedToDo = todo.update('status', status=>'done');\n    var request = objectStore.put(updatedToDo.toJS());\n\n    request.onsuccess = (e) => {\n      console.log('Store: Backend has been updated.');\n      var index = this.items.indexOf(todo);\n\n      this.items.splice(index, 1, updatedToDo);\n      this.trigger(this.filtered);\n    };\n  },\n  onActionUncheck (data) {\n    var todo = data;\n\n    console.log('Store: Checking item as \"open\": %s = %s', todo.get('id'), todo.get('summary'));\n    var objectStore = this.db.transaction(['todos'], \"readwrite\")\n      .objectStore('todos');\n\n    var updatedToDo = todo.update('status', status=>'open');\n    var request = objectStore.put(updatedToDo.toJS());\n\n    request.onsuccess = (e) => {\n      console.log('Store: Backend has been updated.');\n      var index = this.items.indexOf(todo);\n\n      this.items.splice(index, 1, updatedToDo);\n      this.trigger(this.filtered);\n    };\n  },\n  onActionTag (todo, tags) {\n    console.log('Store: Updating item\\'s tags as \"%o\" for %s', tags, todo.get('id'));\n    var objectStore = this.db.transaction(['todos'], \"readwrite\")\n      .objectStore('todos');\n\n    var updatedToDo = todo.update('tags', value=>tags);\n    console.log('Updated: ', updatedToDo.toJS());\n    var request = objectStore.put(updatedToDo.toJS());\n\n    request.onsuccess = (e) => {\n      console.log('Store: Backend has been updated.');\n      var index = this.items.indexOf(todo);\n\n      this.items[index] = updatedToDo;\n      console.log('Item\\'s new tags: ', tags);\n\n      var shouldKeepInFiltered = false;\n      if (this.filteringTags.size===0) {  // There is no filtering\n        shouldKeepInFiltered = true;  // No effect here! Leave here for clarity\n      }\n      else {\n        for (let tag of tags) {\n          if (this.filteringTags.includes(tag)) {\n            shouldKeepInFiltered = true;\n            break;\n          }\n        }\n        // TODO Improve this iteration\n        if (!shouldKeepInFiltered) {\n          var filtered = this.items.filter((item) => {\n            for (let tag of this.filteringTags) {\n              if (item.get('tags').indexOf(tag)!==-1) {\n                return true;\n              }\n            }\n\n            return false;\n          });\n\n          this.filtered = filtered;\n          this.triggerAsync(this.filtered);\n        }\n      }\n    };\n  },\n  onActionFilter (data) {\n    console.log('Store: Filtering by tags: %o', data);\n\n    var tags = data;\n    if (!tags.length) {\n      this.filtered = this.items;\n      this.triggerAsync(this.filtered);\n      return;\n    }\n    this.filteringTags = Immutable.fromJS(tags);\n    console.log('Updated filtering tags: ', this.filteringTags);\n\n    var filtered = this.items.filter((item) => {\n      for (let tag of tags) {\n        if (item.get('tags').indexOf(tag)!==-1) {\n          return true;\n        }\n      }\n\n      return false;\n    });\n\n    this.filtered = filtered;\n    this.triggerAsync(this.filtered);\n  }\n});\n// Views\nvar EditBox = React.createClass({\n  getInitialState () {\n    return {\n      text: ''\n    }\n  },\n  handleChange (event) {\n    this.setState({\n      text: event.target.value\n    });\n  },\n  render () {\n    return (\n      <div className='editbox'>\n        <input ref='taskSummary' placeholder='Default value' value={this.state.text} onChange={this.handleChange} className='editbox__textbox' onKeyUp={this.onTextKeyup} />\n        <button className='editbox__button-add' onClick={this.onAddClicked}>Add</button>\n      </div>\n    )\n  },\n  doAdd () {\n    var taskSummary = this.refs.taskSummary.getDOMNode().value;\n    if (!taskSummary) {\n      return;\n    }\n\n    var todo = newToDo(taskSummary);\n    actionAdd(todo);\n\n    this.refs.taskSummary.getDOMNode().value = null;\n  },\n  onTextKeyup (e) {\n    if (e.keyCode !== 13) return;\n\n    this.doAdd();\n  },\n  onAddClicked () {\n    this.doAdd();\n  }\n});\n\nvar TagBox = React.createClass({\n  statics: {\n    tags: [\n      { value: 'home', label: 'Home' },\n      { value: 'work', label: 'Work' },\n      { value: 'star', label: 'Star' }\n    ]\n  },\n  getInitialState () {\n    return {\n      tags: []\n    };\n  },\n  render () {\n    var selectedTags = this.state.tags;\n\n    var tagList = TagBox.tags.map((tag) => {\n      var classes = cx({\n        'tagbox__item': true,\n        'is-checked': selectedTags.indexOf(tag.value) !== -1,\n        ['is-' + tag.value]: true\n      });\n      return (\n        <span className={classes}\n              onClick={this.toggleFilter.bind(null, tag.value)}\n              key={tag.value}>\n          {tag.label}\n        </span>\n      );\n    });\n\n    return (\n      <div className=\"tagbox\">\n        {tagList}\n      </div>\n    );\n  },\n  toggleFilter (tag) {\n    console.log('Adding more tag to the filter: %s', tag);\n\n    var tags = this.state.tags;\n    var index = tags.indexOf(tag);\n\n    if (index === -1) {\n      tags.push(tag);\n    } else {\n      tags.splice(index, 1);\n    }\n\n    console.log('Filtering by tags: %o', tags);\n    this.setState({\n      tags: tags\n    });\n\n    actionFilter(tags);\n  }\n});\n\nvar Tags = React.createClass({\n  statics: {\n    tags: [\n      { value: 'home', label: 'Home' },\n      { value: 'work', label: 'Work' },\n      { value: 'star', label: 'Star' }\n    ]\n  },\n  getInitialState () {\n    return {\n      tags: Immutable.fromJS(this.props.tags || []),\n      editing: false\n    };\n  },\n  render () {\n    var classes = cx({\n      'todo-tags': true,\n      [this.props.className]: true,\n      'is-editing': this.state.editing,\n      'is-tagged': this.state.tags.size > 0\n    });\n\n    var dropdown;\n\n    if (this.state.editing) {\n      dropdown = (\n        <ul className=\"todo-tags__dropdown\">\n          {Tags.tags.map(tag => <li key={tag.value} className=\"todo-tags__item\" onClick={this.toggleTag.bind(this, tag.value)}>{tag.label}</li>)}\n        </ul>\n      );\n    }\n\n    return (\n      <div className={classes} onClick={this.toggleEdit} onBlur={this.endEdit} tabIndex=\"0\">\n        <span className=\"todo-tags__label\">\n          {this.state.tags.size===0?'tags':this.state.tags.map(tag => {\n            var classes = cx({\n              'todo-tags__value': true,\n              ['is-' + tag]: true\n            });\n\n            return (<span className={classes}>{tag}</span>);\n          })}\n        </span>\n        {dropdown}\n      </div>\n    );\n  },\n  toggleEdit (e) {\n    e.stopPropagation();\n\n    if (this.state.editing) {\n      this.endEdit();\n    } else {\n      this.beginEdit();\n    }\n  },\n  beginEdit () {\n    if (this.state.editing) {\n      return;\n    }\n\n    this.setState({'editing': true});\n    Tags.activeID = null; //this.getID();\n  },\n  endEdit () {\n    console.log('Ending edit...');\n\n    if (Tags.active && Tags.active === this) {\n      Tags.active = null;\n    }\n\n    this.setState({'editing': false});\n  },\n  toggleTag (tag, e) {\n    e.stopPropagation();\n\n    var tags = this.state.tags;\n    if (!tags) {\n      console.assert(!tags, 'Tags is expected');\n      return;\n    }\n\n    var index = tags.indexOf(tag);\n    if (index === -1) {\n      tags = tags.push(tag);\n    } else {\n      tags = tags.delete(index);\n    }\n\n    this.setState({\n      tags: tags\n    });\n\n    var onToggleTag = this.props.onToggleTag;\n    if (!onToggleTag) {\n      console.info('No handler for onToggleTag');\n      return;\n    }\n\n    onToggleTag(tags);\n    this.endEdit();\n  }\n})\n\nvar ToDoList = React.createClass({\n  getInitialState () {\n    return {\n      items: Immutable.fromJS(storeTodos.items)\n    };\n  },\n  componentDidMount () {\n    this.stopListening = storeTodos.listen((data)=>{\n      this.setState({\n        items: Immutable.fromJS(data) // Freeze the object state\n      })\n    });\n  },\n  componentWillUnmount () {\n    this.stopListening();\n  },\n  render () {\n    var content;\n    if (!this.state.items.size) {\n      content = (\n        <div className='todo-list'>\n          <p className=\"todo-list__message\">\n            You have nothing to do!\n          </p>\n        </div>\n      );\n    }\n    else {\n      let items = (this.state.items.map((item)=>{\n        var boundRemovedClicked = this.onRemovedDelegate.bind(this, item);\n        var boundItemClicked = item.get('status')==='done'?this.onUncheckDelegate.bind(this, item):this.onCheckDelegate.bind(this, item);\n        var boundItemTag = this.onTagDelegate.bind(this, item);\n\n        var classes = cx({\n          'todo-list__item todo-item': true,\n          'is-checked': item.get('status')==='done'\n        });\n\n        return (\n          <li className={classes} key={item.get('id')}>\n            <span className='todo-item__checkmark' onClick={boundItemClicked}></span>\n            <span className='todo-item__summary'>{item.get('summary')}</span>\n            <Tags className='todo-item__tags' tags={item.get('tags')} editable='true' onToggleTag={boundItemTag} />\n            <button className='todo-item__remove' onClick={boundRemovedClicked}>&#10008;</button>\n          </li>\n        );\n      }));\n      //*/\n      content = (\n        <ul className='todo-list'>\n          {items}\n        </ul>\n      );\n    }\n\n    return content;\n  },\n  onCheckDelegate (item) {\n    actionCheck(item);\n  },\n  onUncheckDelegate (item) {\n    actionUncheck(item);\n  },\n  onRemovedDelegate (item) {\n    actionRemove(item);\n  },\n  onTagDelegate (item, tags) {\n    console.log('Tags applied to item %s: %o', item.get('summary'), tags);\n    actionTag(item, tags);\n  }\n});\n"]},"metadata":{},"sourceType":"module"}